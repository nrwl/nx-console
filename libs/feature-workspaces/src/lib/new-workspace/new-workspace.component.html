<ui-task-runner *ngIf="schematicCollectionsForNgNew$|async as schematicCollectionsForNgNew" terminalWindowTitle="Task output">
  <div class="ui-flags" *ngIf="ngNewForm$|async as form">
    <form [formGroup]="form">
      <mat-accordion [multi]="true" displayMode="flat">
        <mat-expansion-panel [expanded]="true">
          <mat-expansion-panel-header>
            <mat-panel-title [class.error]="form.hasError('required', 'path') && form.get('path')?.touched">
              1. Select a&nbsp;
              <b>path</b>&nbsp;for your new workspace {{ form.get('path')?.value ? ' - ' + form.get('path')?.value : '' }}
            </mat-panel-title>
          </mat-expansion-panel-header>

          <input [hidden]="true" formControlName="path" required>
          <ui-directory-selector [selectedNode]="selectedNode" [handleNodeCreation]="setPathField.bind(this)"></ui-directory-selector>

        </mat-expansion-panel>

        <mat-expansion-panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>
              2. Set a&nbsp;
              <b>name</b>&nbsp;for your new workspace {{ form.get('name')?.value ? ' - ' + form.get('name')?.value : '' }}
            </mat-panel-title>
          </mat-expansion-panel-header>

          <div fxLayout="column" fxFlex>
            <mat-form-field appearance="outline">
              <mat-label>Workspace Name</mat-label>
              <input matInput placeholder="MyNewWorkspace" required formControlName="name">
              <mat-hint>The name of your new workspace.</mat-hint>
            </mat-form-field>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel [expanded]="false">
          <mat-expansion-panel-header>
            <mat-panel-title>
              3. Choose which&nbsp;
              <b>schematics</b>&nbsp;you would like to use {{ form.get('collection')?.value ? ' - ' + form.get('collection')?.value
              : '' }}
            </mat-panel-title>
          </mat-expansion-panel-header>

          <div fxLayout="column" fxFlex>
            <mat-radio-group formControlName="collection">
              <div *ngFor="let n of schematicCollectionsForNgNew; trackBy: trackByName">
                <mat-radio-button [value]="n.name">{{ n.name }}</mat-radio-button>
                <p>{{ n.description }}</p>
              </div>
            </mat-radio-group>
          </div>

        </mat-expansion-panel>
      </mat-accordion>

      <div class="submit-button-container">
        <button mat-raised-button [disabled]="form.invalid" color="primary" (click)="createNewWorkspace(form.value)">Create New Workspace</button>
      </div>
    </form>

  </div>
  <ui-terminal [command]="command$|async" [input]="(commandOutput$|async)?.out"></ui-terminal>
</ui-task-runner>